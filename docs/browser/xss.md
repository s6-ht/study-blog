# XSS详解

跨站脚本攻击（Cross Site Scripting）简称XSS，是一种代码注入攻击，通过注入恶意代码，使之在浏览器中运行，从而拿到用户信息进行操作。XSS攻击分为三类：存储型、反射型和DOM型。

#### 1. 存储型
该类型就是将恶意代码存储到了目标网站的数据库中，当客户端请求时，服务将包含恶意代码的数据从数据库中取出，返回给客户端。客户端执行代码导致数据被窃取。常见于评论、论坛发帖等场景下。
#### 2. 反射型
攻击者构造出包含恶意代码的url，当用户打开该url的时候，向服务发起请求，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。常见于通过url传递参数的功能，如网站搜索、跳转等。

反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。

#### 3. DOM型
文档型的 XSS 攻击并不会经过服务端，而是作为中间人的角色，在数据传输过程劫持到网络数据包，然后修改里面的 html 文档！常见为WIFI路由器劫持或者本地恶意软件等。


#### 4. 预防

- 输入过滤，让其不可执行
- 设置httpOnly，禁止客户端读取cookie，即使攻击者完成了XSS攻击，也不能获取到cookie
- 利用 CSP，即浏览器中的内容安全策略，核心思想是服务器决定浏览器加载哪些资源，主要包括以下：
  - 限制其他域下的资源加载。
  - 禁止向其它域提交数据。
  - 提供上报机制，能帮助我们及时发现 XSS 攻击。

